var authNextPage='#';function authShowModal(url){authNextPage=url;$('#auth_modal').modal('show');}
function authNext(){if(authNextPage.length>0){if(authNextPage[0]=='#'){window.location.reload();}else{window.location.href=authNextPage;}}else{window.location.reload();}}
function authShowRegister(){$('#auth_modal').modal('hide');if(authNextPage.length>0){if(authNextPage[0]=='#'){window.location.href='/accounts/register/?next='+window.location.pathname;}else{window.location.href='/accounts/register/?next='+authNextPage;}}else{window.location.href='/accounts/register/';}}
$('#auth_submit').off('click.authenication').on('click.authenication',function(e){var elem=$(this);var tab=$('#auth_modal form:visible').closest('.tab-pane');elem.prop('disabled',true);if(tab.attr('id')=='auth_login'){$.post(tab.attr('data-target'),$('#auth_login_form').serialize(),function(result){elem.prop('disabled',false);$('#auth_login_form [id^="auth_login_error"]').addClass('hidden').text('');if(result.success){$('#auth_modal').modal('hide');authNext();}else{if(result.otc)$('#auth_login_one_time_code').removeClass('hidden');for(i=0;i<result.errors.length;i++){if(result.errors[i][0]=='__all__'){$('#auth_login_error').removeClass('hidden').text(result.errors[i][1]);}else{$('#auth_login_error_'+result.errors[i][0]).removeClass('hidden').text(result.errors[i][1]);}}}});}else if(tab.attr('id')=='auth_reset'){$.post(tab.attr('data-target'),$('#auth_reset_form').serialize(),function(result){elem.prop('disabled',false);$('#auth_reset_form [id^="auth_reset_error"]').addClass('hidden').text('');if(result.success){$('#auth_modal').modal('hide');authNextPage='/accounts/reset/done/';authNext();}else{for(i=0;i<result.errors.length;i++){if(result.errors[i][0]=='__all__'){$('#auth_reset_error').removeClass('hidden').text(result.errors[i][1]);}else{$('#auth_reset_error_'+result.errors[i][0]).removeClass('hidden').text(result.errors[i][1]);}}}});}});