
(function(document,window){console.log("GDPR: 1.4");window.HDN=window.HDN||{};window.HDN.GDPR={CONSENT_OK_SERVICES:[],CONSENT_ASK:true,COUNTRY_CODE:null,IS_EU:false,DNT:(navigator.doNotTrack||navigator.msDoNotTrack||window.doNotTrack||"0"),isIFrame:false,GROUPS:{"editorial":{"label":"Editorial, Functionality and Social Media Cookies","summary":"We use third-party services for commenting, videos, and embedding posts as part of our news coverage. The providers of these cookies may use the data as explained in their privacy policies.","toggle":true},"business":{"label":"Performance, Content Recommendation and Personalization Cookies","summary":"We use our own and third-party services to provide content recommendations and customize your user experience and advertising. The providers of these cookies may use the data as explained in their privacy policies.","toggle":true},"analytics":{"label":"Analytics","summary":"We use cookies to analyze and measure traffic to the site so that we know our audience, what stories are read, where visitors come from, and how long they stay. You can opt out of these analytics cookies by unselecting the boxes below.","toggle":false},},POLICIES:{"basic":{"directives":{"default-src":"'self' *.hearstnp.com","img-src":"'self' data: *.hdnux.com *.hearstnp.com p.ctpost.com *.ensighten.com blob:","script-src":"'self' 'unsafe-inline' *.ensighten.com *.hearstnp.com projects.sfchronicle.com files.sfchronicle.com blob:","style-src":"'self' 'unsafe-inline' *.hearstnp.com","object-src":"'none'","font-src":"'self' fonts.googleapis.com fonts.gstatic.com treg.hearstnp.com www.sfchronicle.com","frame-src":"'self' *.hearstnp.com projects.sfchronicle.com","media-src":"'self' *.hearstnp.com","connect-src":"'self' *.hearstnp.com ampcid.google.com ampcid.google.co.uk ampcid.google.de ampcid.google.fr ampcid.google.nl ampcid.google.it ampcid.google.no ampcid.google.es ampcid.google.ie projects.sfchronicle.com files.sfchronicle.com api.mapbox.com events.mapbox.com api.rainviewer.com tilecache.rainviewer.com","prefetch-src":"'self' *.hearstnp.com"}},"parsely":{"label":"Parsely","summary":"Collect analytics and allow for content optimization.","privacy":"https://www.parse.ly/privacy-policy/","group":"analytics","directives":{"img-src":"*.pixel.parsely.com","script-src":"'unsafe-eval' *.pixel.parsely.com d1z2jf7jlzjs58.cloudfront.net"},"initialState":true},"google-analytics":{"label":"Google Analytics","summary":"We collect and analyze website data to understand our visitors and improve the user experience.","privacy":"https://privacy.google.com/businesses/compliance/","group":"analytics","directives":{"img-src":"www.google-analytics.com","script-src":"www.google-analytics.com"},"initialState":true},"chartbeat":{"label":"Chartbeat","summary":"We use this to identify what users are doing on the site in real time.","privacy":"https://chartbeat.com/privacy/","group":"analytics","directives":{"script-src":"static.chartbeat.com","img-src":"ping.chartbeat.net",},"initialState":true},"non-personlaized-ads":{"label":"Non-Personalized Ads","summary":"","privacy":"","group":"npads","directives":{"default-src":"tpc.googlesyndication.com","script-src":"*.2mdn.net adservice.google.co.uk adservice.google.de adservice.google.fr adservice.google.nl adservice.google.it adservice.google.no adservice.google.es adservice.google.ie www.googletagservices.com adservice.google.com cm.g.doubleclick.net securepubads.g.doubleclick.net stats.g.doubleclick.net pagead2.googlesyndication.com","frame-src":"tpc.googlesyndication.com","img-src":"*.2mdn.net stats.g.doubleclick.net","prefetch-src":"tpc.googlesyndication.com","connect-src":"securepubads.g.doubleclick.net"},"whitelisted":true},"jwp":{"label":"JW Player","summary":"","privacy":"https://www.jwplayer.com/privacy/","group":"editorial","directives":{"default-src":"cdn.jwplayer.com","script-src":"content.jwplatform.com ssl.p.jwpcdn.com","img-src":"cdn.jwplayer.com jwpltx.com assets-jpcust.jwpsrv.com","style-src":"","media-src":"videos-f.jwpsrv.com cdn.jwplayer.com blob:","frame-src":"g.jwpsrv.com","connect-src":"cdn.jwplayer.com entitlements.jwplayer.com videos-f.jwpsrv.com assets-jpcust.jwpsrv.com"},"whitelisted":true},"trusted-third-party":{"label":"Trusted Third Party","summary":"","privacy":"","group":"trusted-third-party","directives":{"img-src":"*.basemaps.cartocdn.com","style-src":"unpkg.com"},"whitelisted":true},"twitter":{"label":"Twitter","summary":"We use Twitter for embedding tweets in our stories.","privacy":"https://twitter.com/en/privacy","group":"editorial","directives":{"script-src":"platform.twitter.com syndication.twitter.com cdn.syndication.twimg.com","img-src":"pbs.twimg.com abs.twimg.com syndication.twitter.com","style-src":"platform.twitter.com ton.twimg.com",}},"facebook":{"label":"Facebook","summary":"We use Facebook for embedding posts in our stories.","privacy":"https://www.facebook.com/policy","group":"editorial","directives":{"script-src":"www.facebook.com connect.facebook.net","img-src":"www.facebook.com www.facebook.com *.fbcdn.net fbsbx.com","style-src":"www.facebook.com","media-src":"*.fbcdn.net","frame-src":"www.facebook.com staticxx.facebook.com"}},"taboola":{"label":"Taboola","summary":"Provides advertising and content recommendations to website visitors.","privacy":"https://www.taboola.com/privacy-policy","group":"business","directives":{"default-src":"trc.taboola.com","img-src":"images.taboola.com","script-src":"*.taboola.com","style-src":"*.taboola.com","img-src":"cdn.taboola.com images.taboola.com"}},"nativo":{"label":"Nativo","summary":"","group":"business","privacy":"https://www.nativo.com/privacy-policy/","directives":{"script-src":"s.ntv.io jadserve.postrelease.com z.moatads.com","style-src":"","img-src":"s.ntv.io jadserve.postrelease.com ntvcld-a.akamaihd.net ntvassets-a.akamaihd.net"}},"blueconic":{"label":"Blueconic","summary":"Allows us to test experiences, add personalization, and include new features.","group":"business","privacy":"https://support.blueconic.com/hc/en-us/articles/360002229274-FAQ-Consent-Privacy-Management-for-GDPR","directives":{}},"realm":{"label":"Realm","summary":"To provide login and registration services for the site,","group":"business","privacy":"","directives":{"default-src":"treg.hearstnp.com realm.hearstnp.com realm.hearst3pcc.com","script-src":"treg.hearstnp.com realm.hearstnp.com realm.hearst3pcc.com ajax.googleapis.com casper-services-prod-dot-eco-cyclist-168716.appspot.com","style-src":"fonts.googleapis.com","img-src":"storage.googleapis.com","connect-src":"casper-services-prod-dot-eco-cyclist-168716.appspot.com"}},},Icon:'<svg id="gdpr-privacy-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 128"><path d="M88,35L128,53.6v49.61c0,6.23-7.74,15.67-20.71,25.23A179.41,179.41,0,0,1,88,140.69a179.37,179.37,0,0,1-19.29-12.25c-13-9.56-20.71-19-20.71-25.23V53.6L88,35m0-11L38,47.22v56C38,127.33,88,152,88,152s50-24.67,50-48.79v-56Zm22.46,68.9c0-13-45-13-45,0v18h45v-18ZM88,56.25A12.85,12.85,0,1,0,100.85,69.1,12.85,12.85,0,0,0,88,56.25" transform="translate(-38 -24)"/></svg>',debug:false,init:function(){var isOkBrowser=this.isOkBrowser();if(!isOkBrowser){console.log('GDPR: Browser not supported',isOkBrowser);window.location.replace('https://s3.amazonaws.com/hnpassets/gdpr/support.html');return;}
this.readLocation();this.processConsent();this.checkDebugMode();this.checkIfIFrame();if(this.IS_EU&&this.isIFrame){console.log('GDPR: Visitor is EU but page is a child iframe');this.addCSPPolicies();return;}
if(this.IS_EU&&this.checkMetaTag()){console.log('GDPR: Meta tag requests hiding consent form');this.addCSPPolicies();return;}
if(this.IS_EU){console.log('GDPR: Add styles');this.addStyles();}
if(this.CONSENT_ASK){this.renderConsentForm();}
if(this.IS_EU){console.log('Visitor is EU so add CSP and Button');this.addCSPPolicies();this.addButton();var x={'COUNTRY_CODE':this.COUNTRY_CODE,'IS_EU':this.IS_EU,'DNT':this.DNT,'CONSENT_ASK':this.CONSENT_ASK,'DEBUG':this.debug};if(typeof console.table==='function'){console.table(x);console.table(this.CONSENT_OK_SERVICES);}else{console.log(x);}}},checkIfIFrame:function(){this.isIFrame=(window.top!==window.self);},checkMetaTag:function(){var m=document.querySelector("meta[name='privacy']")||false;if(m){var c=m.getAttribute("content")||false;if(c){if(c.toLowerCase()=="hide-form"){return true;}}}
return false;},processConsent:function(){if(this.IS_EU){this.readConsent();}else{this.CONSENT_ASK=false;}},getParam:function(p){var s=new RegExp('[?&]'+p+'=([^&#]*)','i').exec(window.location.href);return s?s[1]:null;},checkDebugMode:function(){if(this.getParam('is_eu')==='1'){this.IS_EU=true;this.debug=true;}
var debugServices=this.getParam('gdpr_services');if(debugServices){this.debug=true;if(debugServices==='none'){this.CONSENT_ASK=true;}else{this.CONSENT_ASK=false;this.CONSENT_OK_SERVICES=debugServices.split(',');}}
if(this.debug){console.warn('GDPR debug mode is turned on:',this.IS_EU,this.CONSENT_ASK,this.CONSENT_OK_SERVICES);}},addCSPPolicies:function(services){console.log("Add CSPs");var self=window.HDN.GDPR;var starterCSP=this.POLICIES.basic;var contentSecurityPolicy={'default-src':HDN.GDPR.POLICIES['basic'].directives['default-src']||'','img-src':HDN.GDPR.POLICIES['basic'].directives['img-src']||'','script-src':HDN.GDPR.POLICIES['basic'].directives['script-src']||'','style-src':HDN.GDPR.POLICIES['basic'].directives['style-src']||'','object-src':HDN.GDPR.POLICIES['basic'].directives['object-src']||'','font-src':HDN.GDPR.POLICIES['basic'].directives['font-src']||'','frame-src':HDN.GDPR.POLICIES['basic'].directives['frame-src']||'','media-src':HDN.GDPR.POLICIES['basic'].directives['media-src']||'','connect-src':HDN.GDPR.POLICIES['basic'].directives['connect-src']||'','prefetch-src':HDN.GDPR.POLICIES['basic'].directives['prefetch-src']||'',};for(var key in self.POLICIES){if(self.POLICIES.hasOwnProperty(key)){if(self.POLICIES[key].whitelisted){var directives=self.POLICIES[key].directives;contentSecurityPolicy=self.appendDirectives(contentSecurityPolicy,directives);}}}
var host=this.getDomain();var subdomains=["projects","code","extras","files","www"];var len=subdomains.length;for(var i=0;i<len;i++){var d=subdomains[i]+"."+host;contentSecurityPolicy=self.appendDirectives(contentSecurityPolicy,{"script-src":d,"img-src":d,"media-src":d,"style-src":d,"font-src":d,"frame-src":d,"connect-src":d});}
if(self.CONSENT_ASK&&!self.isIFrame){for(var key in self.POLICIES){if(self.POLICIES.hasOwnProperty(key)){if(self.POLICIES[key].initialState){var directives=self.POLICIES[key].directives;contentSecurityPolicy=self.appendDirectives(contentSecurityPolicy,directives);}}}}
self.CONSENT_OK_SERVICES.forEach(function(serviceId){var service=self.POLICIES[serviceId]||false;if(service){var directives=service.directives;contentSecurityPolicy=self.appendDirectives(contentSecurityPolicy,directives);}});var metaContent=[];for(var key in contentSecurityPolicy){if(contentSecurityPolicy.hasOwnProperty(key)){metaContent.push(key+" "+contentSecurityPolicy[key]+"; ");}}
metaContent=metaContent.join("");var contentSecurityPolicyTag="<meta http-equiv=\"Content-Security-Policy\" content=\""+metaContent+"\">";if(typeof console.table==='function'){console.table(contentSecurityPolicy);}else{console.log(contentSecurityPolicy);}
document.write(contentSecurityPolicyTag);},appendDirectives:function(csps,directives){for(var key in directives){if(directives.hasOwnProperty(key)){if(typeof csps[key]!=='undefined'){csps[key]+=' '+directives[key];}}}
return csps;},readLocation:function(){var isEU=false;var countryCode=null;var a="location_data";var b=document.cookie.match('(^|;)\\s*'+a+'\\s*=\\s*([^;]+)');if(b){var data=JSON.parse(decodeURIComponent(b.pop()));if(typeof data['is_eu']!=='undefined'){if(data['is_eu']){isEU=true;}}
if(typeof data['country_code']!=='undefined'){countryCode=data['country_code'];}
console.log("Cookie: ",a,data);}
this.IS_EU=isEU;this.COUNTRY_CODE=countryCode;},readConsent:function(){var consentServices=[];var consentAsk=true;var a="_consent_cookie";var b=document.cookie.match('(^|;)\\s*'+a+'\\s*=\\s*([^;]+)');if(b){var data=JSON.parse(decodeURIComponent(b.pop()));if(typeof data['services']!=='undefined'){if(data['services'].length>0){consentServices=data['services'];}}
console.log("Cookie: ",a,data);consentAsk=false;}
this.CONSENT_OK_SERVICES=consentServices;this.CONSENT_ASK=consentAsk;},updateConsent:function(){var enabledServices=[];var enabledServiceEls=document.querySelectorAll('input.gdpr-service:checked');var len=enabledServiceEls.length;for(var i=0;i<len;i++){var serviceName=enabledServiceEls[i].getAttribute('data-service')||false;if(serviceName){enabledServices.push(serviceName);}}
this.CONSENT_OK_SERVICES=enabledServices;var a='_consent_cookie';var b=JSON.stringify({services:enabledServices});var expirationDate=new Date;expirationDate.setFullYear(expirationDate.getFullYear()+1);document.cookie=a+'='+b+'; expires='+expirationDate.toGMTString()+'; path=/';},isOkBrowser:function(){var ua=navigator.userAgent;return(/MSIE/i.test(ua)||/Opera Mini/i.test(ua))?false:true;},getPoliciesByGroup:function(group){var policies=[];for(var key in this.POLICIES){if(this.POLICIES.hasOwnProperty(key)){var policy=HDN.GDPR.POLICIES[key];if(!policy.group){continue;}
if(policy.group===group){policy.id=key;policies.push(policy);}}}
return policies;},renderConsentForm:function(){var groupsHTML='';var self=HDN.GDPR;if(self.isIFrame){console.log("Skipping GDPR form for iframed page");return;}
for(var key in self.GROUPS){if(self.GROUPS.hasOwnProperty(key)){var group=self.GROUPS[key];var policies=self.getPoliciesByGroup(key);var listHTML='';var len=policies.length;for(var i=0;i<len;i++){var summaryHTML='';var privacyHTML='';var service=policies[i];if(service.whitelisted){continue;}
if(service.privacy){privacyHTML='(<a class="privacy-link" href="'+service.privacy+'" target="_blank">Privacy Policy</a>)';}
if(service.summary){summaryHTML=service.summary;}
var checked='';if(self.CONSENT_OK_SERVICES.indexOf(service.id)>-1){checked='checked ';}
if(self.CONSENT_ASK){if(service.initialState==true){checked='checked ';}}
listHTML+=['<li>','<input '+checked+'data-service="'+service.id+'" class="gdpr-service" id="gdpr-service-'+service.id+'" type="checkbox" >','<label for="gdpr-service-'+service.id+'" class="gdpr-checkbox">',service.label,'</label>','<span>',privacyHTML,'</span>','</li>'].join("");}
if(group.toggle){listHTML+=['<li class="gdpr-list-footer">','<button class="small" data-group="'+key+'" data-action="all">Select All</button>','</li>'].join("");}
var summaryHTML="";if(group.summary){summaryHTML='<span>'+group.summary+'</span>';}
groupsHTML+=['<h6>'+group.label+'</h6>',summaryHTML,'<ul id="gdpr-group-'+key+'" class="gdpr-group">',listHTML,'</ul>'].join("\n");}}
var privacyNoticeLink=self.getPrivacyPolicyLink();var publisherText=self.getPublisherText();var titleText='Your Choices Regarding Cookies';var introText=['We and third parties may deploy cookies and similar technologies when you use our site. ','Please review the information below and select the cookies that you want to enable. ','You can continue to the site without accepting these cookies but certain features may not be available or function properly.'].join('');var html=['<div id="gdpr-consent-overlay"></div>','<div id="gdpr-consent-form">','<div id="gdpr-consent-wrapper">','<div id="gdpr-consent-header">','<h5>'+self.Icon+' '+titleText+'</h5>','<span>'+introText+'</span>','</div>','<div id="gdpr-consent-content">',groupsHTML,'</div>','<div id="gdpr-consent-footer">','<a href="'+privacyNoticeLink+'" target="_blank">Privacy Notice</a>','<button id="continue">Continue</button>','</div>','</div>','</div>'].join("\n");var div=document.getElementById('gdpr-modal')||false;if(!div){div=document.createElement('DIV');div.id='gdpr-modal';div.innerHTML=html;if(document.readyState==='complete'||document.readyState==='loaded'){document.body.appendChild(div);document.body.className+=' gdpr-modal-on';self.addConsentEvents();self.redrawHeight();}else{document.addEventListener('DOMContentLoaded',function(){document.body.appendChild(div);document.body.className+=' gdpr-modal-on';window.HDN.GDPR.addConsentEvents();window.HDN.GDPR.redrawHeight();});window.addEventListener('load',function(){window.HDN.GDPR.redrawHeight();});}}else{div.innerHTML=html;}},getPrivacyPolicyLink:function(){var host=this.getDomain();if(host=='hearstmediact.com'){host='ctpost.com'}
var privacyNoticeLink="/privacy/";var a=["middletownpress.com","nhregister.com","sfgate.com","thetelegraph.com","myjournalcourier.com"];var b=["sfchronicle.com","houstonchronicle.com","chron.com"];if(a.indexOf(host)>-1){privacyNoticeLink="/privacy-policy/";}else if(b.indexOf(host)>-1){privacyNoticeLink="/privacy_policy/";}else if(host=="timesunion.com"){privacyNoticeLink="/privacypolicy/";}else if(host=="beaumontenterprise.com"){privacyNoticeLink="/services/privacy/";}
return"https://www."+host+privacyNoticeLink;},redrawHeight:function(){var groupsEl=document.getElementById("gdpr-consent-content")||false;if(groupsEl){var wrapperH=document.getElementById("gdpr-consent-wrapper").clientHeight;var headerH=document.getElementById("gdpr-consent-header").clientHeight;var footerH=document.getElementById("gdpr-consent-footer").clientHeight;groupsEl.style.height=(wrapperH-headerH-footerH-14)+"px";}},addConsentEvents:function(){var modal=document.getElementById('gdpr-modal')||false;if(modal){modal.addEventListener('click',window.HDN.GDPR.updateConsentPrefs,false);if(!/Mobi/.test(navigator.userAgent)){window.addEventListener('resize',function(){window.HDN.GDPR.redrawHeight();});}}},updateConsentPrefs:function(e){var el=e.target;if(el.nodeName==='INPUT'){var service=el.getAttribute('data-service')||false;if(service){var isChecked=el.checked;window.HDN.GDPR.updateButtonLabel();}}else if(el.nodeName==='BUTTON'){if(el.id==='continue'){window.HDN.GDPR.updateConsent();window.HDN.GDPR.removeConsentForm();window.HDN.GDPR.logConsent();window.HDN.GDPR.CONSENT_UPDATED=true;window.location.reload(false);}else{window.HDN.GDPR.toggleGroupSelections(el);}}},toggleGroupSelections:function(button){var group=button.getAttribute("data-group");var action=button.getAttribute("data-action")||"none";var selector="#gdpr-group-"+group+" input.gdpr-service";var els=document.querySelectorAll(selector);for(var i=0;i<els.length;i++){els[i].checked=(action==="all")?true:false;}
if(action==="all"){button.setAttribute("data-action","none");button.innerText="Clear All";}else{button.setAttribute("data-action","all");button.innerText="Select All";}},removeConsentForm:function(){document.body.className=document.body.className.replace('gdpr-modal-on','').trim();var modal=document.getElementById('gdpr-modal')||false;if(modal){modal.parentNode.removeChild(modal);}},getPublisherText:function(){var publisherText='Hearst Newspapers';var meta=document.querySelector("meta[name='publisher']");if(meta){publisherText=meta.getAttribute('content')||publisherText;}
return publisherText;},addButton:function(){if(window.HDN.GDPR.isIFrame){console.log("Skipping GDPR button for iframed page");return;}
var div=document.createElement('DIV');div.id='gdpr-button-fixed';div.innerHTML=['<div>',window.HDN.GDPR.Icon,'<span>Privacy Settings</span>','</div>'].join("");document.addEventListener('DOMContentLoaded',function(){document.body.appendChild(div);div.addEventListener('click',window.HDN.GDPR.renderConsentForm,false);});},updateButtonLabel:function(){var btn=document.querySelector("#gdpr-consent-footer button");if(btn){var num=document.querySelectorAll('input.gdpr-service:checked').length;var label="Continue";if(num===0){label="Continue";}else{label="Consent to "+num+((num===1)?" Service":" Services");}
btn.innerText=label;}},addStyles:function(){var link=document.createElement('link');var href=this.getStylesUrl();link.rel="stylesheet";link.type="text/css";link.href=href+"?"+parseInt(Date.now()/10000,10);document.addEventListener('DOMContentLoaded',function(){var hasCSS=document.querySelector("link[type='text/css'][href*='gdpr']")||false;if(!hasCSS){document.head.appendChild(link);}});},getStylesUrl:function(){var host=this.getDomain();if(host=='hearstmediact.com'){host='ctpost.com'}
var url="https://www."+host+"/file/305/6/3056-gdpr-min.css";return url;},getDomain:function(){return location.hostname.split(".").slice(-2).join(".");},logConsent:function(){window.HDN.dataLayer=window.HDN.dataLayer||{};window.HDN.dataLayer.site=window.HDN.dataLayer.site||{};window.HDN.dataLayer.content=window.HDN.dataLayer.content||{};var uid="none";if((typeof HDN.getAtUser==="function")){uid=HDN.getAtUser();}else{if(HDN.dataLayer.site.gtvt_partner_id){uid="gtvt_"+HDN.dataLayer.site.gtvt_partner_id;}}
var ref=document.referrer.replace("http://","").replace("https://","");var params={'type':'consent','domain':document.domain,'ts':Date.now(),'uid':uid,'aid':HDN.dataLayer.content.objectId||"",'services':window.HDN.GDPR.CONSENT_OK_SERVICES.join(",")||'none','ref':encodeURIComponent(ref)};var url=location.protocol+"//p.ctpost.com/?"+Object.keys(params).map(function(key){return key+'='+params[key]}).join('&');new Image().src=url;}};window.HDN.GDPR.init();})(document,window);